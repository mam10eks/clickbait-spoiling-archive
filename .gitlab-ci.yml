stages:
  - check-runner
  - evaluate-run
  - copy-evaluation-to-tira

check-runner:
  stage: check-runner
  image: curlimages/curl
  script:
    - echo "Check that the runner is trustworthy."
    - ./tira-test-runner-is-trustworthy.sh
  tags:
    - no-internet
    
evaluate-run:
  stage: evaluate-run
  artifacts:
    untracked: true
  image: "${IMAGE_TO_EXECUTE}"
  variables:
    INPUT_RUN: "dummy-input-run"
    OUTPUT_DIR: "dummy-output-dir"
    IMAGE_TO_EXECUTE: "ubuntu:16.02sa4"
  script:
    - ls /mnt/ceph/tira/data/
    - ls /mnt/ceph/tira/data/runs/
    - ls /mnt/ceph/tira/data/datasets/test-datasets-truth/
    - echo "${INPUT_RUN}"
    - echo "${OUTPUT_DIR}"
    - touch evaluation-result.jsonl
  tags:
    - no-internet
    - read-tira-data-datasets-truth
    - read-tira-data-runs

copy-evaluation-to-tira:
  stage: copy-evaluation-to-tira
  script:
    - echo "This job moves the evaluation result to the TIRA directory. ToDo here, we need write-tira-data-runs"
    - ls -l .
    - ls /mnt/ceph/tira/data/
    - ls /mnt/ceph/tira/data/runs/
  dependencies: 
    - evaluate-run
  tags:
    - write-tira-data-runs

